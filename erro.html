<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erro no Sistema</title>
    <style>
        * {
            font-family: Arial, Helvetica, sans-serif;
            padding: 0;
            margin: 0;
        }
        
        html,
        body {
            height: 100%;
        }
        
        #layout-error {
            padding: 0;
            background: #fff;
            position: relative;
            height: 100%;
        }
        
        .main-top {
            background: #333;
            padding: 3%;
            border-bottom: 4px solid olive;
        }
        
        #exception {
            background: #333;
            float: left;
            padding: 2%;
            color: #fff;
            width: 62%;
        }
        
        #traces {
            float: left;
            background: #ccc;
            width: 34%;
            height: 50em;
            position: relative;
            font-size: 1rem;
        }
        
        .trace {
            background: #f1f1f1;
            padding: 2%;
            border-bottom: 2px solid #ccc;
        }
        
        .text-white {
            color: white;
        }
        
        .code {
            padding: 1%;
            position: relative;
            margin: 0px;
            float: left;
            background: #112233;
            width: 64%;
            font-size: 100%;
        }
        
        .line-error {
            color: #ff9933 !important;
        }
        
        .arquivo {
            color: #3f8f03;
        }
        
        .linha {
            color: #355;
        }
        
        .line {
            color: #999;
        }
        
        .funcao {
            color: #ff3333;
        }
        
        .php {
            color: #09a0e0;
        }
        
        .public {
            color: #04bfb9;
        }
        
        .common-line {
            color: #09DEE9;
        }
    </style>
</head>

<body>
    <div id="layout-error" scrollable>
        <div class="main-top">
            <h1 class="text-white">Erro no Servidor (500)</h1>
        </div>
        <div id="traces">
            <div class="trace">
                <p class="arquivo">Arquivo:C:\apache24\htdocs\juridico\apps\controllers\prazo.php
                    <p class="linha">Linha: 22
                        <p class="funcao">Função: model</div>
            <div class="trace">
                <p class="arquivo">Arquivo:C:\apache24\htdocs\juridico\core\Router.php
                    <p class="linha">Linha: 334
                        <p class="funcao">Função: dataencerramento</div>
            <div class="trace">
                <p class="arquivo">Arquivo:C:\apache24\htdocs\juridico\core\Silas.php
                    <p class="linha">Linha: 118
                        <p class="funcao">Função: run</div>
            <div class="trace">
                <p class="arquivo">Arquivo:C:\apache24\htdocs\juridico\index.php
                    <p class="linha">Linha: 21
                        <p class="funcao">Função: require</div>
        </div>
        <div id="exception">
            <p>Erro: Class 'Prazo' not found</p>
            <p>Pasta: \core</p>
            <p>Arquivo: Controller.php</p>
            <p>Linha: 69</p>
        </div>
        <div class="code"> <pre><span class="line">1.</span> <span class="php">&lt;?php</span> <span class="line">2.</span> <span class="common-line"> </span><span class="line">3.</span> <span class="common-line">namespace core; </span><span class="line">4.</span> <span class="common-line"> </span><span class="line">5.</span> <span class="common-line">class Controller{ </span><span class="line">6.</span> <span class="common-line"> </span><span class="line">7.</span> <span class="common-line"> public function __construct(){ </span><span class="line">8.</span> <span class="common-line"> </span><span class="line">9.</span> <span class="common-line"> } </span><span class="line">10.</span> <span class="common-line"> /** </span><span class="line">11.</span> <span class="common-line"> * Carrega uma view </span><span class="line">12.</span> <span class="common-line"> * @author: Daniel Faria </span><span class="line">13.</span> <span class="common-line"> */ </span><span class="line">14.</span> <span class="common-line"> public function view($view,$dados=''){ </span><span class="line">15.</span> <span class="common-line"> //Crio uma nova instancia da classe router e pego a pasta admin </span><span class="line">16.</span> <span class="common-line"> $router = new Router; </span><span class="line">17.</span> <span class="common-line"> $pasta = $router->set_app_dir(); </span><span class="line">18.</span> <span class="common-line"> $subpasta = $router->set_sub_folder(); </span><span class="line">19.</span> <span class="common-line"> //Se estou em uma pasta dentro de apps, entao vou buscar uma view dentro de apps/pasta/views </span><span class="line">20.</span> <span class="common-line"> if(isset($pasta)){ </span><span class="line">21.</span> <span class="common-line"> $viewfile = appdir."/".$pasta."/views/{$view}.php"; </span><span class="line">22.</span> <span class="common-line"> }else{ </span><span class="line">23.</span> <span class="common-line"> $viewfile = appdir."/views/{$view}.php"; </span><span class="line">24.</span> <span class="common-line"> } </span><span class="line">25.</span> <span class="common-line"> //echo $viewfile.br; </span><span class="line">26.</span> <span class="common-line"> //Verificando se o arquivo existe </span><span class="line">27.</span> <span class="common-line"> if(file_exists($viewfile)){ </span><span class="line">28.</span> <span class="common-line"> if(isset($dados) && $dados!='' && count($dados,COUNT_NORMAL)>0) </span><span class="line">29.</span> <span class="common-line"> { </span><span class="line">30.</span> <span class="common-line"> //Ler o conteudo da view </span><span class="line">31.</span> <span class="common-line"> $content = file_get_contents($viewfile); </span><span class="line">32.</span> <span class="common-line"> //$html =''; </span><span class="line">33.</span> <span class="common-line"> //Substituir dados na view </span><span class="line">34.</span> <span class="common-line"> foreach($dados as $chave=>$valor){ </span><span class="line">35.</span> <span class="common-line"> $content = str_replace('{'.$chave.'}',$valor,$content); </span><span class="line">36.</span> <span class="common-line"> //$conteudo = $content; </span><span class="line">37.</span> <span class="common-line"> } </span><span class="line">38.</span> <span class="common-line"> print eval('?>'. $content); </span><span class="line">39.</span> <span class="common-line"> }else{ </span><span class="line">40.</span> <span class="common-line"> include_once(appdir."/".$pasta."/views/{$view}.php"); </span><span class="line">41.</span> <span class="common-line"> } </span><span class="line">42.</span> <span class="common-line"> //O arquivo indicado não existe, então mostro mensagem de erro </span><span class="line">43.</span> <span class="common-line"> }else{ </span><span class="line">44.</span> <span class="common-line"> echo "Arquivo {$view} nao encontrado"; </span><span class="line">45.</span> <span class="common-line"> } </span><span class="line">46.</span> <span class="common-line"> </span><span class="line">47.</span> <span class="common-line"> } </span><span class="line">48.</span> <span class="common-line"> </span><span class="line">49.</span> <span class="common-line"> public function model($model){ </span><span class="line">50.</span> <span class="common-line"> //Crio uma nova instancia da classe router e pego a pasta admin </span><span class="line">51.</span> <span class="common-line"> $router = new Router; </span><span class="line">52.</span> <span class="common-line"> $pasta = $router->set_app_dir(); </span><span class="line">53.</span> <span class="common-line"> //Se estou na pasta admin, entao vou buscar um model dentro de site/admin/model </span><span class="line">54.</span> <span class="common-line"> if(isset($pasta)){ </span><span class="line">55.</span> <span class="common-line"> if(file_exists(appdir."/".$pasta."/models/{$model}.php")){ </span><span class="line">56.</span> <span class="common-line"> require_once (appdir."/".$pasta."/models/{$model}.php"); </span><span class="line">57.</span> <span class="common-line"> }else{ </span><span class="line">58.</span> <span class="common-line"> echo "Arquivo {$model} nao encontrado"; </span><span class="line">59.</span> <span class="common-line"> } </span><span class="line">60.</span> <span class="common-line"> //Senao vou buscar na pasta /model </span><span class="line">61.</span> <span class="common-line"> }else{ </span><span class="line">62.</span> <span class="common-line"> if(file_exists(modeldir."/{$model}.php")){ </span><span class="line">63.</span> <span class="common-line"> require_once (modeldir."/{$model}.php"); </span><span class="line">64.</span> <span class="common-line"> }else{ </span><span class="line">65.</span> <span class="common-line"> echo "Arquivo nao encontrado"; </span><span class="line">66.</span> <span class="common-line"> } </span><span class="line">67.</span> <span class="common-line"> } </span><span class="line">68.</span> <span class="common-line"> //Encontrei o model. Entao crio uma nova instancia de Model e retorno ela para o Controller </span><span class="line">69.</span> <span class="line-error common-line"> $model = new $model; </span><span class="line">70.</span> <span class="common-line"> return $model; </span><span class="line">71.</span> <span class="common-line"> } </span><span class="line">72.</span> <span class="common-line"> </span><span class="line">73.</span> <span class="common-line"> /** </span><span class="line">74.</span> <span class="common-line"> * Carrega uma view e seus dados para dentro de um template. </span><span class="line">75.</span> <span class="common-line"> * Deve ser capaz nao so de carregar os templates, mas capaz de subsitituir variaveis de template </span><span class="line">76.</span> <span class="common-line"> * @param $template - arquivo usado como template </span><span class="line">77.</span> <span class="common-line"> * @param $view - Arquivo que sera carregado dentro do template </span><span class="line">78.</span> <span class="common-line"> * @param $dados - Conjunto de dados que serao passados para a view </span><span class="line">79.</span> <span class="common-line"> * @param $global - Define se o template sera enxergavel atraves de toda a aplicacao ou apenas na </span><span class="line">80.</span> <span class="common-line"> * pasta onde o controller esta sendo carregado </span><span class="line">81.</span> <span class="common-line"> */ </span><span class="line">82.</span> <span class="common-line"> public function template($template,$view='',$dados='',$global=false){ </span><span class="line">83.</span> <span class="common-line"> /* </span><span class="line">84.</span> <span class="common-line"> * Crio uma nova instancia da classe router e pego a pasta de </span><span class="line">85.</span> <span class="common-line"> * onde estou acessando o controller </span><span class="line">86.</span> <span class="common-line"> */ </span><span class="line">87.</span> <span class="common-line"> $router = new router; </span><span class="line">88.</span> <span class="common-line"> $controldir = $router->set_app_dir(); </span><span class="line">89.</span> <span class="common-line"> //$dados = $dados; </span><span class="line">90.</span> <span class="common-line"> /* </span><span class="line">91.</span> <span class="common-line"> * Se o parametro global for setado como false, o controller deve buscar o template dentro da </span><span class="line">92.</span> <span class="common-line"> * pasta aplicacao/subpasta/view, caso contrario, busca o template na pasta </span><span class="line">93.</span> <span class="common-line"> * aplicao/view </span><span class="line">94.</span> <span class="common-line"> */ </span><span class="line">95.</span> <span class="common-line"> if(isset($controldir)){ </span><span class="line">96.</span> <span class="common-line"> $template = appdir."/".$controldir."/views/{$template}.php"; </span><span class="line">97.</span> <span class="common-line"> $viewfile = appdir."/".$controldir."/views/{$view}.php"; </span><span class="line">98.</span> <span class="common-line"> }else{ </span><span class="line">99.</span> <span class="common-line"> $template = appdir."/views/{$template}.php"; </span><span class="line">100.</span> <span class="common-line"> $viewfile = appdir."/views/{$view}.php"; </span><span class="line">101.</span> <span class="common-line"> } </span><span class="line">102.</span> <span class="common-line"> </span><span class="line">103.</span> <span class="common-line"> //Carrega o template </span><span class="line">104.</span> <span class="common-line"> if(file_exists($template)){ </span><span class="line">105.</span> <span class="common-line"> </span><span class="line">106.</span> <span class="common-line"> /* </span><span class="line">107.</span> <span class="common-line"> Leitura de dados passados para a view </span><span class="line">108.</span> <span class="common-line"> */ </span><span class="line">109.</span> <span class="common-line"> if(isset($dados) && $dados!='' && count($dados,COUNT_NORMAL)>0){ </span><span class="line">110.</span> <span class="common-line"> //Ler o conteudo da view </span><span class="line">111.</span> <span class="common-line"> $content = file_get_contents($viewfile); </span><span class="line">112.</span> <span class="common-line"> $tcontent = file_get_contents($template); </span><span class="line">113.</span> <span class="common-line"> //Substituir dados na view </span><span class="line">114.</span> <span class="common-line"> foreach($dados as $chave=>$valor){ </span><span class="line">115.</span> <span class="common-line"> $content = str_replace('{'.$chave.'}',$valor,$content); </span><span class="line">116.</span> <span class="common-line"> $tcontent = str_replace('{'.$chave.'}',$valor,$tcontent); </span><span class="line">117.</span> <span class="common-line"> $template = $tcontent; </span><span class="line">118.</span> <span class="common-line"> $conteudo = $content; </span><span class="line">119.</span> <span class="common-line"> } </span><span class="line">120.</span> <span class="common-line"> $viewfile = $content; </span><span class="line">121.</span> <span class="common-line"> print eval('?>'. $template); </span><span class="line">122.</span> <span class="common-line"> }else{ </span><span class="line">123.</span> <span class="common-line"> include($template); </span><span class="line">124.</span> <span class="common-line"> } </span><span class="line">125.</span> <span class="common-line"> /* Fim da leitura de dados*/ </span><span class="line">126.</span> <span class="common-line"> }else{ </span><span class="line">127.</span> <span class="common-line"> //o template informado nao existe </span><span class="line">128.</span> <span class="common-line"> echo "Arquivo {$template} nao encontrado"; </span><span class="line">129.</span> <span class="common-line"> } </span><span class="line">130.</span> <span class="common-line"> //Fim else </span><span class="line">131.</span> <span class="common-line"> </span><span class="line">132.</span> <span class="common-line"> } </span><span class="line">133.</span> <span class="common-line"> </span><span class="line">134.</span> <span class="common-line"> public function load($pasta,$classe){ </span><span class="line">135.</span> <span class="common-line"> require_once basedir().'/sistema/'.$pasta.'/'.$classe.'.php'; </span><span class="line">136.</span> <span class="common-line"> $classe = new $classe; </span><span class="line">137.</span> <span class="common-line"> return $classe; </span><span class="line">138.</span> <span class="common-line"> } </span><span class="line">139.</span> <span class="common-line">}</span></pre>            </div>
    </div>
</body>

</html>